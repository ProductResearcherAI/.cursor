# План переработки метаправила 01_meta-rule-analyzis-synthesis workflow.mdc

**Дата создания:** 2024-12-25
**Основание:** Адаптация метаправила под логику правил OHI-S USA Research

Изначальное указание пользователя
  Теперь на основании проекта  OHIS- и правил Интервью анализись C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz

Переделай правило C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\01_meta-rule-analyzis-synthesis workflow.mdc

Во первых, все пункты начиная с  3 сдвинь на один пункт, так как подготовка к интервью это п 2 в папке C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules

В третьиэ начиная с  5. Анализ интервью и формулирование потребностей

Которое ты сделаешь этапом 4 ты сделаешь подобно пунктам
C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz

А правила в папке 4 C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis переработаешь пол правила папки

C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz

Вот этот пункт ты оставишь (5.1)

Пункт 4.3.1 (Переработанный) ты заменишь на пункт с указанием правила гайда для этого правила ддя этого сопоставишь

C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz\3.2.4.interview_guide_filling_rule_ohi_s.mdc 

С релевантным правилом ОХИС и при необходимости доработаешь его

Правило тоже должно быть простым 
Состоит из 2 частей - извлечения гайда и заполенения ответами на вопросы его
Укажи в нем что по дефолту агент предлагает критерии вопросов и критерии вычленения цитат и заполнения ответов гайда

Сделай это правило простым подобным C:\Users\4814285\Desktop\ProductResearchAI\ArbitrA\rules\Trustees_Lawyers\4.2.1_interview_guide_filling_rule.mdc

Всю структуру при переделывании правил сохрани на структуру  изначальную но только с логикой  правил C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz

Пункт 4.2.2  метаправила упрости до оттсылки к правилу гайда что на основании второй его части агент по гайду распределяет цитаты

С обязательной проверкой чтобы все цитаты были включены

Далее C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis\4.3.1_quotes_distribution_rule.mdc
C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis\4.3.2_quotes_distribution_verification_rule.mdc переделай под пункты правила гайда или интегрируй в пункты правила составления гайда и заполнения гайда

А лучгше в действительности разбей сложносоставное правило охис на 2 правила и интегрируй пункты этих правил в него не допустив дублирования

И затем их можно будет удалить 

Затем добавь правило C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz\5.1.1_current_framework_consolidation_rule.mdc
И его применение в последний подэтап этапа 4 консолидацию данных из утвержденного фреймворка в таблицу 

В итоге ты
Пересоберешь пункты метаправила  сдвинув их на одну нумерацию ниже
Пересоберешь правила пункта исключив дублирующие C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis

Перенумеруешь эти правила так чтобы порядок их нумерации соответствовал порядку применения в этапе 4 на основании примеров правил ОХИ-С 

В итоге наведешь порядок в этапах правила 

*5.5.2 Формулирование потребностей клиентов**

Оставь в таком из 3 вариантов (1.2.3) как сейчас есть потому что эту логику я проверил 

В итоге на этом этапе агент вместе с исследователем будет очищать транскрибации, заполнять гайд, консистентно гайду заполнять фреймворк, консолидировать данные из фреймворка в таблицу потребностей, cохраняя в ней данные для последуюшего синтеза

Нумерация правил будет соответствовать  нумерации правил в папке правила

## ЧАСТЬ 1: ДЕТАЛЬНОЕ ИСХОДНОЕ УКАЗАНИЕ ПОЛЬЗОВАТЕЛЯ

### 1.1 Базовые требования к перенумерации

**Основное требование:**
- Все пункты начиная с п.3 сдвинуть на один пункт вниз, так как подготовка к интервью это п.2 в папке `C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules`

### 1.2 Переработка этапа "Анализ интервью и формулирование потребностей"

**Исходный этап 5 → Новый этап 4:**
- Сделать подобно пунктам из `C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz`
- Правила в папке `C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis` переработать под правила из папки OHI-S `3_analyziz`

### 1.3 Детальные требования к подэтапам

#### 1.3.1 Подэтап 5.1 (станет 4.1)
- **Действие:** Оставить существующий пункт без изменений

#### 1.3.2 Подэтап 4.3.1 (Переработанный) 
**Заменить на пункт с указанием правила гайда:**
- **Основа:** Сопоставить `C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz\3.2.4.interview_guide_filling_rule_ohi_s.mdc` с релевантным правилом ОХИС
- **Доработка:** При необходимости доработать правило
- **Структура правила:** Должно быть простым, состоящим из 2 частей:
  1. **Извлечение гайда** - как в `C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis\3.1.2_interview_questions_extraction_rule.mdc`
  2. **Заполнение ответами на вопросы** - по второй части правила OHI-S
- **Дефолтное поведение агента:** По умолчанию агент предлагает:
  - Критерии вопросов 
  - Критерии вычленения цитат
  - Критерии заполнения ответов гайда
- **Стиль:** Сделать простым подобно `C:\Users\4814285\Desktop\ProductResearchAI\ArbitrA\rules\Trustees_Lawyers\4.2.1_interview_guide_filling_rule.mdc`

#### 1.3.3 Подэтап 4.2.2 (Упрощенный)
**Упростить до отсылки к правилу гайда:**
- На основании второй части правила гайда агент распределяет цитаты по гайду
- **Обязательная проверка:** Все цитаты должны быть включены

### 1.4 Интеграция существующих правил

#### 1.4.1 Правила для интеграции/переработки:
- `C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis\4.3.1_quotes_distribution_rule.mdc`
- `C:\Users\4814285\Desktop\ProductResearchAI\.cursor\rules\4_interview_analysis\4.3.2_quotes_distribution_verification_rule.mdc`

**Способ интеграции:**
- Переделать под пункты правила гайда ИЛИ
- Интегрировать в пункты правила составления гайда и заполнения гайда

#### 1.4.2 Разбиение сложного правила OHI-S:
- Разбить сложносоставное правило ОХИ-С на 2 правила
- Интегрировать пункты этих правил без дублирования
- После интеграции - удалить дублирующие правила

### 1.5 Добавление правила консолидации

**Новое правило:**
- Добавить правило `C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz\5.1.1_current_framework_consolidation_rule.mdc`
- **Применение:** В последний подэтап этапа 4 - консолидация данных из утвержденного фреймворка в таблицу

### 1.6 Сохранение структуры

**Обязательные требования:**
- Всю структуру при переделывании правил сохранить изначальную
- Изменить только логику правил под `C:\Users\4814285\Desktop\ProductResearchAI\OHI-S_USA_Research\Course_Demand_Assessment\project_rules\3_analyziz`

---

## ЧАСТЬ 2: ФИНАЛЬНЫЙ ПЛАН ДЕЙСТВИЙ

### 2.1 Этап 1: Анализ и подготовка

#### 2.1.1 Изучение исходных материалов
- [x] Прочитать текущее метаправило `01_meta-rule-analyzis-synthesis workflow.mdc`
- [x] Изучить все правила в папке `4_interview_analysis`
- [x] Проанализировать правила OHI-S в папке `3_analyziz`
- [x] Сопоставить логику и выявить точки интеграции

#### 2.1.2 Определение новой структуры
- [x] Определить новую нумерацию этапов (сдвиг на +1 начиная с п.3)
- [x] Спроектировать структуру нового этапа 4 "Анализ интервью"
- [x] Составить план интеграции существующих правил

### 2.2 Этап 2: Переработка метаправила

#### 2.2.1 Обновление основного файла
- [ ] Открыть файл `01_meta-rule-analyzis-synthesis workflow.mdc`
- [ ] Сдвинуть нумерацию пунктов начиная с п.3 на +1
- [ ] Переработать этап 5 в этап 4 "Анализ интервью" 

#### 2.2.2 Создание новой структуры этапа 4
```
4. Анализ интервью и формулирование потребностей
   4.1 Определение границ исследования (из существующего 5.1)
   4.2 Очистка транскрибации (на основе OHI-S логики)
   4.3 Извлечение вопросов (часть 1 из OHI-S + существующая логика)
   4.4 Заполнение гайда с критериями цитат (интегрирует работу с цитатами)
   4.5 Формулирование потребностей (OHI-S логика 3.2.5)
   4.6 Верификация потребностей (OHI-S логика 3.2.6, упрощено до 1 этапа)
   4.7 Консолидация данных в таблицу (адаптация OHI-S 5.1.1)
   4.8 (Опционально) Ведение графа задач в реальном времени
```

### 2.3 Этап 3: Создание новых правил

#### 2.3.1 Правило очистки транскрибации
- [ ] Создать упрощенное правило `4.2.1_text_cleaning_unified_rule.mdc`
- [ ] Интегрировать логику из:
  - `4.1.2.1_interviewer_remarks_removal_rule.mdc`
  - `4.1.2.2_interviewer_remarks_preservation_rule.mdc`
- [ ] Добавить выбор стратегии очистки (с/без реплик интервьюера)

#### 2.3.2 Правило извлечения вопросов  
- [ ] Создать правило `4.3.1_interview_questions_extraction_simple_rule.mdc`
- [ ] На основе существующего `3.1.2_interview_questions_extraction_rule.mdc`
- [ ] Добавить часть 1 из OHI-S `3.2.4_interview_guide_filling_rule_ohi_s.mdc`
- [ ] Добавить извлечение в иерархию вопросов

#### 2.3.3 Правило заполнения гайда
- [ ] Создать правило `4.4.1_interview_guide_filling_simple_rule.mdc`
- [ ] Объединить логику:
  - Часть 2 из OHI-S `3.2.4_interview_guide_filling_rule_ohi_s.mdc`
  - Логику ArbitrA `4.2.1_interview_guide_filling_rule.mdc`
- [ ] Добавить дефолтные критерии от агента

### 2.4 Этап 4: Создание правила работы с цитатами

#### 2.4.1 Правило критериев цитат для исследователя
- [ ] Создать правило с критериями цитат, которые выбирает исследователь для формулирования потребностей
- [ ] Включить это правило в правило перед заполнением гайда (4.4.1)
- [ ] Добавить логику уточнения критериев цитат агентом перед заполнением гайда и фреймворка
- [ ] Интегрировать части:
  - `4.4.1_quotes_identification_rule.mdc`
  - `4.4.2_quotes_enrichment_rule.mdc`  
  - `4.3.1_quotes_distribution_rule.mdc`
  - `4.3.2_quotes_distribution_verification_rule.mdc`
- [ ] Гайд вместе с очищенной транскрибацией будут использоваться на следующем этапе формулирования потребностей

### 2.5 Этап 5: Интеграция формулирования потребностей

#### 2.5.1 Создание базового правила анализа
- [ ] Создать правило `4.6.1_needs_analysis_integrated_rule.mdc`
- [ ] Взять логику из OHI-S правила `3.2.5.needs_formulation_rule_ohi_s.mdc`
- [ ] Интегрировать:
  - `2.1.0_interview_analysis_rule.mdc` (базовый JTBD анализ)
  - Логику формулирования потребностей из OHI-S

#### 2.5.2 Создание правила верификации
- [ ] Создать правило `4.6.2_needs_verification_integrated_rule.mdc`
- [ ] Проверить `4.7.1_needs_formulation_final_verification_rule.mdc` на дублирование в правилах `2.1.2` и `2.1.3`
- [ ] Оставить существующую логику в метаправиле: агент предлагает либо просто сформулировать, либо сформулировать + верифицировать
- [ ] Доработать правила на основании OHI-S правил:
  - `3.2.5.needs_formulation_rule_ohi_s.mdc`
  - `3.2.6.needs_formulation_verification_rule_ohi_s.mdc`
- [ ] Упростить до 1 этапа проверки

### 2.6 Этап 6: Добавление консолидации

#### 2.6.1 Адаптация правила консолидации
- [ ] Создать правило `4.7.1_current_framework_consolidation_adapted_rule.mdc`
- [ ] Адаптировать OHI-S правило `5.1.1_current_framework_consolidation_rule.mdc`
- [ ] Настроить под новую структуру этапа 4

### 2.7 Этап 7: Очистка и финализация

#### 2.7.1 Удаление дублирующих правил
- [ ] Удалить `4.3.1_quotes_distribution_rule.mdc`
- [ ] Удалить `4.3.2_quotes_distribution_verification_rule.mdc`
- [ ] Пометить устаревшие правила как deprecated

#### 2.7.2 Обновление ссылок
- [ ] Обновить все ссылки на правила в метаправиле
- [ ] Проверить консистентность между правилами
- [ ] Обновить документацию и примеры

### 2.8 Этап 8: Тестирование и валидация

#### 2.8.1 Проверка новой структуры
- [ ] Протестировать логику новых правил
- [ ] Проверить отсутствие пропусков в процессе
- [ ] Убедиться в корректности интеграции

#### 2.8.2 Документирование изменений  
- [ ] Создать changelog с описанием изменений
- [ ] Обновить версию метаправила
- [ ] Создать migration guide для существующих проектов

---

## ЧАСТЬ 3: ЛОГИКА ИНТЕГРАЦИИ ПРАВИЛ

### 3.1 Принципы интеграции

#### 3.1.1 Сохранение функциональности
- Все существующие возможности должны быть сохранены
- Логика работы должна остаться понятной
- Упрощение без потери качества

#### 3.1.2 Избежание дублирования
- Одна функция = одно правило
- Четкое разделение ответственности
- Минимизация пересечений

#### 3.1.3 Простота использования
- Меньше файлов для изучения
- Понятная последовательность действий
- Дефолтные настройки от агента

### 3.2 Карта интеграции

```
СТАРАЯ СТРУКТУРА → НОВАЯ СТРУКТУРА

2.1.0_interview_analysis_rule.mdc → 4.6.1_needs_analysis_integrated_rule.mdc
2.1.2_needs_verification_rule.mdc → 4.6.2_needs_verification_integrated_rule.mdc  
2.1.3_needs_formulation_verification_rule.mdc → 4.6.2_needs_verification_integrated_rule.mdc
2.4.1_realtime_customer_jobs_graph_rule.mdc → 4.8.1_realtime_jobs_graph_rule.mdc
3.1.2_interview_questions_extraction_rule.mdc → 4.3.1_interview_questions_extraction_simple_rule.mdc
4.1.1_text_cleaning_rule.mdc → 4.2.1_text_cleaning_unified_rule.mdc
4.1.2.1_interviewer_remarks_removal_rule.mdc → 4.2.1_text_cleaning_unified_rule.mdc
4.1.2.2_interviewer_remarks_preservation_rule.mdc → 4.2.1_text_cleaning_unified_rule.mdc
4.3.1_quotes_distribution_rule.mdc → 4.4.1_interview_guide_filling_simple_rule.mdc (интегрировать)
4.3.2_quotes_distribution_verification_rule.mdc → 4.4.1_interview_guide_filling_simple_rule.mdc (интегрировать)
4.4.1_quotes_identification_rule.mdc → 4.4.1_interview_guide_filling_simple_rule.mdc (интегрировать)
4.4.2_quotes_enrichment_rule.mdc → 4.4.1_interview_guide_filling_simple_rule.mdc (интегрировать)
4.7.1_needs_formulation_final_verification_rule.mdc → проверить на дублирование, оставить существующую логику

OHI-S 3.2.4_interview_guide_filling_rule_ohi_s.mdc → 4.3.1 + 4.4.1 (разбить на 2 правила)
OHI-S 3.2.5.needs_formulation_rule_ohi_s.mdc → 4.6.1_needs_analysis_integrated_rule.mdc
OHI-S 3.2.6.needs_formulation_verification_rule_ohi_s.mdc → 4.6.2_needs_verification_integrated_rule.mdc
OHI-S 5.1.1_current_framework_consolidation_rule.mdc → 4.7.1_current_framework_consolidation_adapted_rule.mdc
```

### 3.3 Результирующая структура правил этапа 4

```
4_interview_analysis/
├── 4.2.1_text_cleaning_unified_rule.mdc (очистка транскрибации)
├── 4.3.1_interview_questions_extraction_simple_rule.mdc (извлечение вопросов)
├── 4.4.1_interview_guide_filling_simple_rule.mdc (заполнение гайда с критериями цитат)
├── 4.6.1_needs_analysis_integrated_rule.mdc (формулирование потребностей - OHI-S логика)
├── 4.6.2_needs_verification_integrated_rule.mdc (верификация потребностей - 1 этап)
├── 4.7.1_current_framework_consolidation_adapted_rule.mdc (консолидация в таблицу)
└── 4.8.1_realtime_jobs_graph_rule.mdc (опционально - граф задач в реальном времени)
```

**Ключевые изменения в структуре:**
- Правило 4.4.1 включает критерии цитат для исследователя и интегрирует работу с цитатами
- Правила формулирования потребностей основаны на OHI-S логике
- Верификация упрощена до 1 этапа проверки  
- Удалены дублирующие правила работы с цитатами
- Сохранена существующая логика выбора формулирования с/без верификации

---

## СЛЕДУЮЩИЕ ШАГИ

1. **Согласование плана** - подтверждение пользователем структуры и логики
2. **Поэтапная реализация** - выполнение пунктов плана по порядку  
3. **Итеративная доработка** - корректировка на основе обратной связи
4. **Финальная валидация** - проверка работоспособности новой структуры

---

## РЕЗЮМЕ ВНЕСЕННЫХ КОРРЕКТИРОВОК

### Ключевые изменения после корректировок пользователя:

1. **Правило очистки транскрибации (4.2.1)** - оставлено в исходной редакции, не объединяется 2 правила
2. **Правило извлечения вопросов (4.3.1)** - убрано упрощение под логику ArbitrA, добавлена часть 1 из OHI-S правила 3.2.4
3. **Правило работы с цитатами (4.4.1)** - создается правило с критериями цитат для исследователя, включается в правило заполнения гайда
4. **Формулирование потребностей (4.5.1 → 4.6.1)** - взята логика из OHI-S правила 3.2.5.needs_formulation_rule_ohi_s.mdc
5. **Верификация потребностей (4.6.2)** - упрощено до 1 этапа проверки, доработано на основании OHI-S правил 3.2.5 и 3.2.6
6. **Сохранение существующей логики** - правило 5.5.2 "Формулирование потребностей клиентов" оставлено в 3 вариантах (1.2.3) как проверенная логика

### Результат:
- **Агент будет:** очищать транскрибации → заполнять гайд → консистентно гайду заполнять фреймворк → консолидировать данные из фреймворка в таблицу потребностей
- **Нумерация правил** соответствует нумерации правил в папке правила
- **Интеграция OHI-S логики** в ключевые этапы анализа и формулирования потребностей
- **Упрощение структуры** без потери функциональности

**Статус:** Готов к реализации ✓  
**Дата последнего обновления:** 2024-12-25  
**Версия плана:** 2.0 (с корректировками) 