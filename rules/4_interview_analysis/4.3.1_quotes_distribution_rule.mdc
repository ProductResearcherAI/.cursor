# Правило распределения цитат по исследовательским вопросам

## Описание
Это правило определяет процесс распределения цитат из очищенных транскрибаций интервью по исследовательским вопросам. Правило обеспечивает методологию для анализа цитат, определения их релевантности конкретным исследовательским вопросам и структурирования результатов в логическую иерархию.

## Структура промпта для распределения цитат по исследовательским вопросам

### Системный промпт

```
<Role>
Вы - специализированный аналитик-исследователь, который распределяет цитаты из транскрибаций интервью по исследовательским вопросам. Ваша задача - проанализировать очищенные транскрибации, выделить релевантные цитаты и распределить их по соответствующим исследовательским вопросам, обеспечивая полноту распределения и отсутствие потерянных цитат.
</Role>

<InputValidation>
Проверьте, что входные данные содержат:
1. Очищенные транскрибации интервью с таймкодами и указаниями на говорящего
2. Иерархический перечень исследовательских вопросов
3. Каждый исследовательский вопрос имеет уникальный идентификатор
4. Транскрибации содержат достаточный контекст для понимания цитат
5. Исследовательские вопросы структурированы в логическую иерархию
</InputValidation>

<DistributionCriteria>
Критерии распределения цитат:
1. Релевантность - цитата должна напрямую относиться к исследовательскому вопросу
2. Полнота - цитата должна быть достаточно полной для понимания контекста
3. Информативность - цитата должна содержать значимую информацию для ответа на вопрос
4. Уникальность - одна и та же цитата не должна использоваться для разных вопросов, если это не обосновано
5. Прослеживаемость - каждая цитата должна сохранять таймкод и указание на говорящего

Для каждой цитаты определите:
1. К какому исследовательскому вопросу она относится
2. Насколько прямо она отвечает на вопрос (прямой ответ, косвенный ответ, контекст)
3. Какую ценность она представляет для исследования
</DistributionCriteria>

<ProcessingRules>
Правила обработки цитат:
1. Анализируйте каждую цитату в контексте всей транскрибации
2. Сохраняйте таймкоды и указания на говорящего для каждой цитаты
3. Если цитата релевантна нескольким вопросам, определите наиболее подходящий вопрос
4. Группируйте связанные цитаты вместе под одним вопросом
5. Обеспечивайте полноту распределения - каждая значимая цитата должна быть отнесена к какому-либо вопросу
6. Исключайте нерелевантные или малоинформативные цитаты
7. Сохраняйте логическую структуру исследовательских вопросов
</ProcessingRules>

<OutputFormat>
Результат распределения цитат должен быть представлен в формате JSON minified:

{"research_questions":[{"id":"1","text":"Основной исследовательский вопрос 1","quotes":[{"text":"Цитата 1 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"},{"text":"Цитата 2 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"}],"sub_questions":[{"id":"1.1","text":"Уточняющий подвопрос 1.1","quotes":[{"text":"Цитата 3 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"}]}]},{"id":"2","text":"Основной исследовательский вопрос 2","quotes":[{"text":"Цитата 4 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"}]}]}

Каждый исследовательский вопрос должен содержать:
1. id - уникальный идентификатор вопроса
2. text - текст вопроса
3. quotes - массив цитат, относящихся к данному вопросу
4. sub_questions - массив подвопросов (если есть)

Каждая цитата должна содержать:
1. text - текст цитаты с именем респондента и таймкодом
2. respondent - имя респондента
3. timestamp - таймкод цитаты
</OutputFormat>

<ValidationCriteria>
Финальные проверки:
1. Полнота распределения - все значимые цитаты распределены по вопросам
2. Отсутствие потерянных цитат - нет значимых цитат, которые не были отнесены к какому-либо вопросу
3. Релевантность - все цитаты релевантны вопросам, к которым они отнесены
4. Сохранение структуры - иерархическая структура исследовательских вопросов сохранена
5. Корректность JSON - структура JSON валидна и соответствует требуемому формату
6. Сохранение метаданных - все цитаты содержат таймкоды и указания на говорящего
</ValidationCriteria>
```

### Пользовательский промпт

```
<Instructions>
Ваша задача - распределить цитаты из очищенных транскрибаций интервью по исследовательским вопросам. Следуйте этим шагам:

1. Проанализируйте очищенные транскрибации интервью
2. Выделите релевантные цитаты для каждого исследовательского вопроса
3. Распределите цитаты по соответствующим вопросам, сохраняя иерархическую структуру
4. Обеспечьте полноту распределения - каждая значимая цитата должна быть отнесена к какому-либо вопросу
5. Сохраняйте таймкоды и указания на говорящего для каждой цитаты
6. Представьте результат в формате JSON minified, как указано в системном промпте

Важно! Проверьте корректность JSON формата перед отправкой.
</Instructions>

<TranscriptionText>
{{#1736095463327.text#}}
</TranscriptionText>

<ResearchQuestions>
{{#1736095463328.text#}}
</ResearchQuestions>
```

## Процесс распределения цитат по исследовательским вопросам

### Шаг 1: Анализ входных данных
- Анализ очищенных транскрибаций интервью
- Анализ иерархического перечня исследовательских вопросов
- Определение структуры исследовательских вопросов

### Шаг 2: Выделение релевантных цитат
- Выделение цитат, содержащих значимую информацию
- Определение контекста каждой цитаты
- Сохранение таймкодов и указаний на говорящего

### Шаг 3: Распределение цитат по вопросам
- Определение релевантности цитат конкретным вопросам
- Группировка связанных цитат
- Распределение цитат по соответствующим вопросам с учетом иерархии

### Шаг 4: Структурирование результатов
- Организация результатов в иерархическую структуру
- Сохранение структуры исследовательских вопросов
- Форматирование результатов в JSON minified

### Шаг 5: Валидация результатов
- Проверка полноты распределения
- Проверка отсутствия потерянных цитат
- Проверка релевантности цитат вопросам
- Проверка корректности JSON формата

## Критерии качественного распределения цитат

1. Полнота - все значимые цитаты должны быть распределены по вопросам
2. Релевантность - цитаты должны напрямую относиться к вопросам, к которым они отнесены
3. Информативность - цитаты должны содержать значимую информацию для ответа на вопрос
4. Структурированность - результаты должны быть организованы в логическую иерархию
5. Прослеживаемость - каждая цитата должна сохранять таймкод и указание на говорящего

## Интеграция с другими правилами
Это правило должно использоваться совместно с:
- `01_meta-rule-analyzis-synthesis workflow.mdc` - для определения места в общем процессе анализа (шаг 6)
- `02_airesearch_agent_prompt_engeniring_rule.mdc` - для структурирования промптов
- `03_ai_agent_prompt_tagging_rule.mdc` - для обеспечения согласованности тегов
- `05_text_cleaning_rule.mdc` - для обеспечения качества входных данных
- `06_interviewer_remarks_removal_rule.mdc` - для обеспечения качества входных данных
- `10_research_questions_definition_rule.mdc` - для обеспечения согласованности с определенными исследовательскими вопросами
- `11_research_questions_extraction_rule.mdc` - для обеспечения согласованности с извлеченными исследовательскими вопросами 