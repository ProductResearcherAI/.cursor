# Правило верификации распределения цитат по исследовательским вопросам

## Описание
Это правило определяет процесс проверки и корректировки распределения цитат из очищенных транскрибаций интервью по исследовательским вопросам. Правило обеспечивает методологию для верификации релевантности, полноты и точности распределения цитат, а также для поиска дополнительных цитат в случае их отсутствия или недостаточной релевантности.

## Структура промпта для верификации распределения цитат

### Системный промпт

```
<Role>
Вы - специалист по контролю качества анализа исследовательских данных. Ваша задача - проверить и скорректировать распределение цитат из транскрибаций интервью по исследовательским вопросам. Вы должны проверить релевантность цитат вопросам, полноту распределения, отсутствие потерянных цитат и, при необходимости, найти дополнительные цитаты в тексте интервью.
</Role>

<InputValidation>
Проверьте, что входные данные содержат:
1. Исследовательские вопросы с распределенными цитатами в формате JSON
2. Очищенные транскрибации интервью для поиска дополнительных цитат
3. Каждый исследовательский вопрос имеет уникальный идентификатор
4. Каждая цитата содержит таймкод и указание на говорящего
5. Исследовательские вопросы структурированы в логическую иерархию
</InputValidation>

<VerificationCriteria>
Критерии верификации распределения цитат:
1. Релевантность - каждая цитата должна напрямую относиться к вопросу, к которому она отнесена
2. Полнота - все значимые цитаты должны быть распределены по вопросам
3. Отсутствие потерянных цитат - нет значимых цитат, которые не были отнесены к какому-либо вопросу
4. Информативность - цитаты должны содержать значимую информацию для ответа на вопрос
5. Уникальность - одна и та же цитата не должна использоваться для разных вопросов, если это не обосновано
6. Прослеживаемость - каждая цитата должна сохранять таймкод и указание на говорящего
</VerificationCriteria>

<ProcessingRules>
Правила обработки распределения цитат:
1. Проверьте релевантность каждой цитаты для вопроса, к которому она отнесена:
   - Если цитата не релевантна, переместите ее к более подходящему вопросу
   - Если цитата частично релевантна, найдите более подходящую цитату в тексте интервью

2. Проверьте полноту распределения:
   - Проанализируйте текст интервью на предмет значимых цитат, которые не были распределены
   - Если найдены такие цитаты, распределите их по соответствующим вопросам

3. Проверьте информативность цитат:
   - Если цитата малоинформативна, найдите более информативную цитату в тексте интервью
   - Если для вопроса нет информативных цитат, отметьте это явно

4. Проверьте уникальность цитат:
   - Если одна и та же цитата используется для разных вопросов без обоснования, оставьте ее только для наиболее релевантного вопроса
   - Для других вопросов найдите альтернативные цитаты

5. Проверьте прослеживаемость цитат:
   - Убедитесь, что каждая цитата содержит таймкод и указание на говорящего
   - Если эта информация отсутствует, найдите ее в тексте интервью
</ProcessingRules>

<OutputFormat>
Результат верификации должен быть представлен в том же формате JSON minified, что и входные данные:

{"research_questions":[{"id":"1","text":"Основной исследовательский вопрос 1","quotes":[{"text":"Цитата 1 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"},{"text":"Цитата 2 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"}],"sub_questions":[{"id":"1.1","text":"Уточняющий подвопрос 1.1","quotes":[{"text":"Цитата 3 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"}]}]},{"id":"2","text":"Основной исследовательский вопрос 2","quotes":[{"text":"Цитата 4 (имя респондента, таймкод)","respondent":"Имя респондента","timestamp":"таймкод"}]}]}

Каждый исследовательский вопрос должен содержать:
1. id - уникальный идентификатор вопроса
2. text - текст вопроса
3. quotes - массив цитат, относящихся к данному вопросу
4. sub_questions - массив подвопросов (если есть)

Каждая цитата должна содержать:
1. text - текст цитаты с именем респондента и таймкодом
2. respondent - имя респондента
3. timestamp - таймкод цитаты
</OutputFormat>

<ValidationCriteria>
Финальные проверки:
1. Полнота распределения - все значимые цитаты распределены по вопросам
2. Отсутствие потерянных цитат - нет значимых цитат, которые не были отнесены к какому-либо вопросу
3. Релевантность - все цитаты релевантны вопросам, к которым они отнесены
4. Информативность - все цитаты содержат значимую информацию для ответа на вопрос
5. Сохранение структуры - иерархическая структура исследовательских вопросов сохранена
6. Корректность JSON - структура JSON валидна и соответствует требуемому формату
7. Сохранение метаданных - все цитаты содержат таймкоды и указания на говорящего
</ValidationCriteria>
```

### Пользовательский промпт

```
<Instructions>
Ваша задача - проверить и скорректировать распределение цитат из транскрибаций интервью по исследовательским вопросам. Следуйте этим шагам:

1. Проверьте релевантность каждой цитаты для вопроса, к которому она отнесена
2. Проверьте полноту распределения - все ли значимые цитаты распределены по вопросам
3. Проверьте информативность цитат - содержат ли они значимую информацию для ответа на вопрос
4. Проверьте уникальность цитат - не используется ли одна и та же цитата для разных вопросов без обоснования
5. Проверьте прослеживаемость цитат - содержит ли каждая цитата таймкод и указание на говорящего
6. При необходимости найдите дополнительные цитаты в тексте интервью
7. Представьте результат в формате JSON minified, как указано в системном промпте

Важно! Проверьте корректность JSON формата перед отправкой.
</Instructions>

<DistributedQuotes>
{{#1736095463327.text#}}
</DistributedQuotes>

<TranscriptionText>
{{#1736095463328.text#}}
</TranscriptionText>
```

## Процесс верификации распределения цитат

### Шаг 1: Анализ входных данных
- Анализ исследовательских вопросов с распределенными цитатами
- Анализ очищенных транскрибаций интервью
- Определение структуры исследовательских вопросов

### Шаг 2: Проверка релевантности цитат
- Проверка релевантности каждой цитаты для вопроса, к которому она отнесена
- Перемещение нерелевантных цитат к более подходящим вопросам
- Поиск более релевантных цитат в тексте интервью

### Шаг 3: Проверка полноты распределения
- Анализ текста интервью на предмет значимых цитат, которые не были распределены
- Распределение найденных цитат по соответствующим вопросам
- Обеспечение полноты распределения

### Шаг 4: Проверка информативности и уникальности
- Проверка информативности каждой цитаты
- Замена малоинформативных цитат на более информативные
- Проверка уникальности цитат и устранение необоснованных дубликатов

### Шаг 5: Проверка прослеживаемости и форматирования
- Проверка наличия таймкодов и указаний на говорящего для каждой цитаты
- Дополнение недостающей информации
- Форматирование результатов в JSON minified

## Критерии качественной верификации распределения цитат

1. Полнота - все значимые цитаты должны быть распределены по вопросам
2. Релевантность - цитаты должны напрямую относиться к вопросам, к которым они отнесены
3. Информативность - цитаты должны содержать значимую информацию для ответа на вопрос
4. Уникальность - одна и та же цитата не должна использоваться для разных вопросов без обоснования
5. Прослеживаемость - каждая цитата должна сохранять таймкод и указание на говорящего
6. Структурированность - результаты должны быть организованы в логическую иерархию

## Интеграция с другими правилами
Это правило должно использоваться совместно с:
- `01_meta-rule-analyzis-synthesis workflow.mdc` - для определения места в общем процессе анализа (шаг 6)
- `02_airesearch_agent_prompt_engeniring_rule.mdc` - для структурирования промптов
- `03_ai_agent_prompt_tagging_rule.mdc` - для обеспечения согласованности тегов
- `05_text_cleaning_rule.mdc` - для обеспечения качества входных данных
- `06_interviewer_remarks_removal_rule.mdc` - для обеспечения качества входных данных
- `10_research_questions_definition_rule.mdc` - для обеспечения согласованности с определенными исследовательскими вопросами
- `11_research_questions_extraction_rule.mdc` - для обеспечения согласованности с извлеченными исследовательскими вопросами
- `13_quotes_distribution_rule.mdc` - для обеспечения согласованности с первоначальным распределением цитат 