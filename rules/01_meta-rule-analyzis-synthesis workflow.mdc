---
description: 
globs: 
alwaysApply: false
---
<rule_metadata>
description: Meta-rule for client communication analysis workflow, including data cleaning, knowledge extraction, verification, and synthesis
globs: .cursor/rules/*.mdc
alwaysApply: false
</rule_metadata>

<rule_title>Meta-Rule: Analysis-Synthesis Workflow</rule_title>

<rule_context>
Перед исполнением этого воркфлоу ознакомься и руководствуйся основным правилом '000-cursor-rules.mdc'
</rule_context>

<agent_work_mode>
- Работа ведется только в среде Cursor
- Агент напрямую исполняет правила как промпты без дополнительного редактирования
- Создает структуру папок для каждого этапа и респондента
- Обеспечивает возможность возврата к любому этапу для любого респондента
- Позволяет выборочно включать резульаты анадиза респондентов в синтез
</agent_work_mode>

<version>3.1.0</version>

<copilot_interaction>
Режим работы AI агента только второй пилот: AI агент активно предлагает действия, но утверждает правила действий и результаты действий с человеком. Каждый результат записывается в соответствующий файл проекта в структуре проекта
</copilot_interaction>

<workflow_stages>
1. Постановка целей
   1.1 Определение исследовательских целей, стадии, бизнес-проблемы, аудитории, контекста исследований, гипотез и ограничений
   - AI агент начинает любой проект с выявления в беседе с исследователем:
     - На какой стадии находится исследование (планируется, вопросы составлены, интервью проведены) - тег `<ResearchStage>`
     - Цели исследования - тег `<ResearchGoals>`
     - Описание бизнес-проблемы - тег `<BusinessProblem>`
     - Целевую аудиторию исследования - тег `<TargetAudience>`
     - Контекст исследования - тег `<ResearchContext>`
     - Ограничения исследования (если есть) - тег `<Limitations>`
     - Предварительные гипотезы (если есть) - тег `<Hypotheses>`
     - Существующие вопросы (если есть) - тег `<ExistingQuestions>`
     - Транскрибации проведенных интервью (если есть) - тег `<TranscriptionText>`
   - AI агент анализирует бизнес-задачу в соответствии с правилом `1.1.1_business_task_types_rule.mdc` для определения типа задачи и `1.1.2_business_task_formulation_rule.mdc` для формулирования и декомпозиции задачи и предлагает свои дополнения которые затем утверждает с исследователем
   - AI агент использует полученную информацию для адаптации исследования и формирования исследовательских вопросов
   Каждое действие утверждается исследователем и результат перезаписывается в соответствующий файл, только после этого агент приступает к следующему этапу

   1.2 Определение исследовательских вопросов на основе целей исследования
   - AI агент использует правило `1.2.1_research_questions_definition_rule.mdc` для  взаимодействия с человеком при определении исследовательских вопросов
   - AI агент анализирует текущее состояние исследования и действует в зависимости от стадии:
     - Если исследование только планируется: предлагает исследователю дефолтные вопросы с использованием библиотеки дефолтных вопросов (`1.2.2_default_research_questions_library.mdc`) и утверждает их
     - Если вопросы составлены, но интервью не проведены: анализирует и дополняет существующие вопросы с использованием библиотеки дефолтных вопросов, вносит в библиотеку дефолтных вопросов изменения предложенные исследователем и обновляет вопросы в папке проекта
     - Если интервью уже проведены: предлагает исследователю пооаналитзировать вопросы интервью и добавить в исследовательские вопросы проекта другие вопросы и осуществляет это после согласия исследователя
   - AI агент обязательно сохраняет утвержденные исследовательские вопросы в проектной структуре в папке `0_business_task` в форматах MD, в перечень актуальных вопросов

2. Подготовка к интервью
   2.1 Определение фреймворка для определения потребностей пользователей
   - AI агент предлагает по дефолту фреймворк JTBD и его структуру исходя из правила `2.1.1_jtbd_framework_rule.mdc`
   - AI агент собирает обратную связь от пользователя и предлагает к утверждению конкретные элементы фреймворка
   - После утверждения исследователем фреймворка Агент создает файл с Framework_structure.md в папке с названием проекта, в файле содержатся выбранные элементы фреймворка + раздел с пояснением как примененеие элементов поможет получить ответы на исследовательские вопросы и достичь бизнес-целей
   - На основании утвержденного фреймворка Framework_structure.md  AI агент испольщует правила `2.1.2_needs_formulation_rule.mdc` для формулирования потребностей и `2.1.3_needs_formulation_verification_rule.mdc` для верификации формулировок потребностей, сохраняя их консистентность
   - На основании утвержденного фреймворка AI агент предлагает дополнения к вопросам интервью для выявления элементов графа потребностей в соответствии с фреймворком во время интервью, для этого использует библиотеку вопросов для выявления потребностей

   2.2 Определение вопросов интервью на основе исследовательских вопросов и выбранного фреймворка
   - AI агент работает в два этапа:

   Этап 1 - Базовые вопросы для исследовательских целей:
   - Использует правило `2.2.1_interview_questions_definition_rule.mdc`
   - Анализирует утвержденные исследовательские вопросы (см. этап 1.2)
   - Формулирует 2 вопроса интервью для каждого исследовательского вопроса
   - Группирует вопросы по тематическим блокам
   - Сохраняет черновик вопросов в `interview_preparation/` (например, `interview_guide*.md`)
   
   Этап 2 - Вопросы для выявления потребностей и недополученной ценности (на основе фреймворка):
   - Анализирует утвержденный фреймворк в файле `Framework_structure.md` (создается на этапе 2.1).
   - Соотносит вопросы, сформулированные на Этапе 1, с элементами утвержденного фреймворка.
   - Выявляет, какие элементы фреймворка недостаточно раскрыты существующими вопросами.
   - На основе правила с детализирующими JTBD-вопросами (`2.2.2_JTBD_Questions`) предлагает добавить конкретные вопросы или блоки вопросов для глубокого "прокапывания" недостающих элементов фреймворка (например, для детализации проблем, ценностей, драйверов, барьеров и т.д.).
   - **Согласование с исследователем:** Представляет исследователю предложенные дополнительные вопросы и уточняет, какие из них являются приоритетными для детального изучения в рамках интервью (учитывая ограничения по времени). Может предложить свою приоритизацию.
   - **Финализация:** Только после утверждения исследователем приоритетов и конкретных формулировок, AI агент интегрирует утвержденные детализирующие вопросы в соответствующие тематические блоки гайдов интервью (`interview_preparation/interview_guides/guide_*.md`).
   
   Процесс поддержки:
   - Обновляет вопросы/гайды после каждого этапа согласования.
   - Добавляет подсказки для интервьюера по ходу доработки гайда (на этапе 2.3).
   - Утверждает все изменения с исследователем.

   2.3 Создание гайда интервью на основе вопросов интервью
   - AI агент использует правило `2.3.1_interview_guide_creation_rule.mdc` для создания структурированного гайда интервью
   - Процесс включает:
     - Анализ утвержденных вопросов интервью
     - Структурирование гайда с четкими разделами (введение, блоки вопросов, заключение)
     - Добавление подсказок и инструкций для интервьюера
     - Представление проекта гайда интервью исследователю для обсуждения и корректировки
     - Внесение изменений на основе обратной связи
   - Гайд интервью должен иметь логическую структуру с последовательностью от общих вопросов к частным
   - AI агент обязательно сохраняет согласованный гайд в проектной структуре в папке `1_data_preparation` в форматах MD
   - AI агент не переходит к следующему этапу без явного согласования гайда интервью с исследователем

3. Организация интервью
   3.1 Проведение тестового интервью с синтетическим респондентом
   - AI агент предлагает исследователю провести тестовое интервью с синтетическим респондентом перед реальными интервью
   - AI агент использует правило `3.1.1_synthetic_respondent_interview_rule.mdc` для проведения тестового интервью
   - Процесс включает:
     - AI агент выступает в роли респондента, отвечая на вопросы из гайда интервью
     - Исследователь задает вопросы по гайду и уточняющие вопросы
     - AI агент предлагает исследователю уточняющие вопросы в ключевых моментах
     - AI агент фиксирует все вопросы и ответы в структурированном виде
     - AI агент формирует гипотезы о потребностях на основе ответов синтетического респондента
     - AI агент предлагает рекомендации по улучшению гайда интервью
   - AI агент сохраняет результаты тестового интервью в проектной структуре в папке `1_data_preparation/synthetic_respondent_[timestamp]`
   - AI агент использует правило `3.1.2_interview_questions_extraction_rule.mdc` для извлечения вопросов из тестового интервью и их интеграции в гайд
   - AI агент не переходит к следующему этапу без явного согласования результатов тестового интервью с исследователем

   3.2 Создание интро и фоллоу-ап сообщений для приглашения респондентов
   - AI агент предлагает исследователю создать вовлекающие сообщения для приглашения потенциальных респондентов на интервью
   - AI агент использует правило `3.2.1_interview_invitation_messages_rule.mdc` для создания интро и фоллоу-ап сообщений
   - Процесс включает:
     - Анализ гипотез, выявленных в ходе интервью с синтетическими респондентами 
     - Анализ гипотез, которые предложит исследователь
     - Формулирование верхнеуровневых бизнес-задач, которые решает продукт
     - Разработку двух вариантов интро-сообщений с фокусом на инновационности и УСП
     - Разработку двух вариантов фоллоу-ап сообщений, дополняющих первичные сообщения
     - Обоснование созданных сообщений с точки зрения выявленных потребностей
   - AI агент сохраняет разработанные сообщения в проектной структуре в папке `interview_preparation`
   - AI агент не переходит к следующему этапу без явного согласования сообщений с исследователем

   3.3 Персонализированная коммуникация с респондентами
   - AI агент предлагает исследователю создать персонализированные сообщения для приглашения конкретных респондентов на интервью
   - AI агент использует правило `3.3.1_interview_personalized_messages_rule.mdc` для создания персонализированных интро и фоллоу-ап сообщений
   - Процесс включает:
     - Сбор информации о респондентах (имя, контактные данные, местоположение, временная зона)
     - Сбор информации о предыдущем опыте взаимодействия респондентов с продуктом/сервисом
     - Создание списка респондентов с контактными данными
     - Адаптацию шаблонов сообщений с учетом профессионального опыта и интересов каждого респондента
     - Расчет временных зон и определение оптимального времени для проведения интервью
     - Персонализацию предложений по времени проведения интервью с учетом временных зон
     - Проверку и валидацию всей информации о респондентах и расчетов временных зон
   - AI агент сохраняет список респондентов в проектной структуре в файле `interview_preparation/respondent_list.md`
   - AI агент сохраняет персонализированные сообщения в проектной структуре в файле `interview_preparation/personalized_messages.md`
   - AI агент не переходит к следующему этапу без явного согласования персонализированных сообщений с исследователем

4. Анализ интервью и формулирование потребностей
   4.1 Определение границ исследования: фактов из историй общения с клиентами, которые будут использоваться для ответа на исследовательские вопросы, и содержания диалога с пользователем, который не имеет смысла
   - АI агент вместе с исследователем выбирает что исключить из анализа интервью с клиентами и удалить из текста -нерелевантные исследованию данные, ответы на которые не дадут прояснение любых исследовательских вопросов
   - Используйте правило `4.1.1_text_cleaning_rule.mdc` для определения и редактирования критериев очистки текста
   - Используйте правило `4.1.2_interviewer_remarks_removal_rule.mdc` для определения и редактирования требований к очистке текста от заметок и ответов интервьюера

   4.2 Подготовка историй общения с клиентами, очищение историй от фрагментов, которые не попадают в границы исследования
   - AI агент предлагает исследователю критерии очистки текста в соответствии с правилами п.7
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент выполняет очистку текста с использованием утвержденных правил как промптов

   4.3 Анализ историй общения с клиентами: извлечение вопросов и распределение цитат
   
   4.3.1 - Извлечение и структурирование вопросов интервью:
   - AI агент:
     - Получает базовые вопросы интервью из файла в папке проекта (п.4) в файле interview_questions.md
     - Анализирует транскрибацию интервью в папке с именем респондента
     - Извлекает дополнительные вопросы из транскрибации согласно `3.1.2_interview_questions_extraction_rule.mdc`
     - Объединяет базовые и извлеченные вопросы в иерархическую структуру
     - Сохраняет в папку респондента в файл `interview_questions_<respondent_name>.md`
   
   4.3.2 - Распределение цитат по вопросам:
   - AI агент использует последовательно правила:
     - `4.3.1_quotes_distribution_rule.mdc` для извлечения цитат
     - `4.3.2_quotes_distribution_verification_rule.mdc` для проверки корректности
     - `4.3.3_quotes_rag_structuring_rule.mdc` для структурирования
   - Сохраняет результат в папку респондента в файл `interview_answers_<respondent_name>.md`
   
   Процесс поддержки:
   - Утверждает с исследователем структуру и содержание файлов
   - Обновляет файлы при получении обратной связи
   - Сохраняет все изменения в соответствующие файлы проекта

   4.4 Идентификация и обогащение значимых цитат из интервью
   - AI агент предлагает исследователю критерии идентификации и обогащения цитат в соответствии с правилами `4.4.1_quotes_identification_rule.mdc` и `4.4.2_quotes_enrichment_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент выполняет идентификацию и обогащение цитат с использованием утвержденных правил как промптов
   - Если исследователь предоставляет обратную связь о том, что не все значимые цитаты были выявлены, AI агент корректирует критерии идентификации и обогащения цитат и повторяет процесс

   4.5 Анализ ответов на исследовательские вопросы
   - AI агент предлагает исследователю критерии формулировки потребностей в соответствии с правилом `4.5.1_needs_formulation_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент формулирует потребности клиентов с использованием утвержденного правила как промпта

   4.6 Верификация точности формулировок потребностей клиентов
   - AI агент предлагает исследователю критерии верификации потребностей в соответствии с правилом `4.6.1_needs_formulation_verification_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент проверяет точность формулировок потребностей с использованием утвержденного правила как промпта

   4.7 Финальная верификация корректности формулировок
   - AI агент предлагает исследователю критерии финальной верификации в соответствии с правилом `4.7.1_needs_formulation_final_verification_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент проводит финальную проверку формулировок потребностей с использованием утвержденного правила как промпта

   4.8 Структурирование итоговых знаний о потребностях клиентов
   - AI агент предлагает исследователю критерии структурирования потребностей
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в критерии на основе обратной связи
   - Исследователь утверждает финальную версию критериев
   - AI агент структурирует верифицированные потребности клиентов в соответствии с утвержденными критериями
   - AI агент выполняет структурирование с использованием утвержденных критериев как промпта

   4.9 Проверка готовности к синтезу и подготовка к синтезу потребностей
   - AI агент уточняет у исследователя:
     - Проведены ли все запланированные интервью
     - Достаточно ли собрано инсайтов для синтеза
     - Готов ли исследователь перейти к этапу синтеза
   - Если исследователь подтверждает готовность к синтезу:
     - AI агент предлагает дефолтные правила синтеза (4.9.1_default_synthesis_rule.mdc) на доработку
     - Исследователь вносит необходимые корректировки в правила синтеза
     - AI агент сохраняет скорректированные правила синтеза (4.9.2_synthesis_rule.mdc)
   - Если исследователь не готов к синтезу:
     - AI агент предлагает продолжить сбор данных или анализ имеющихся интервью

5. Синтез общих знаний о сегменте
   5.1 Синтез знаний об общих для сегмента клиентов элементах потребностей
   - AI агент предлагает исследователю критерии синтеза в соответствии с правилом `4.9.2_synthesis_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент осуществляет синтез потребностей с использованием утвержденного правила как промпта
   - AI агент представляет результаты в виде таблицы с общими паттернами

   5.2 Проверка результатов синтеза на отсутствие упущенных уникальных элементов
   - AI агент проверяет, что все выявленные в результате анализа потребности учтены в синтезе
   - При необходимости AI агент корректирует результаты синтеза

   5.3 Подбор подтверждающих цитат для синтезированных потребностей
   - AI агент предлагает исследователю критерии подбора цитат в соответствии с правилом `5.3.1_quotes_matching_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент находит для каждого элемента синтезированных потребностей до 3 различных цитат с использованием утвержденного правила как промпта
   - AI агент обеспечивает уникальность цитат и их релевантность элементам потребностей
   - AI агент сохраняет таймкоды и имена респондентов для каждой цитаты

   5.4 Верификация подтверждающих цитат
   - AI агент предлагает исследователю критерии верификации цитат в соответствии с правилом `5.4.1_quotes_verification_rule.mdc`
   - Исследователь анализирует предложенные критерии и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финальную версию правил
   - AI агент проверяет наличие цитат для каждого элемента потребностей с использованием утвержденного правила как промпта
   - AI агент проверяет релевантность цитат элементам потребностей
   - AI агент проверяет наличие таймкодов и имен респондентов
   - При необходимости AI агент находит дополнительные цитаты

6. Сенсмейкинг
   6.1 Определение продуктовых гипотез на основе синтезированных знаний
   - AI агент формулирует продуктовые гипотезы на основе синтезированных потребностей клиентов
   - AI агент проводит экспресс-оценку ROI для каждой гипотезы
   - AI агент представляет результаты в виде структурированного документа
   - AI агент составляет ценностное предложение для решенческих интервью

7. Релиз
   7.1 Подготовка к решенческим интервью
   - AI агент помогает команде подготовить материалы для решенческих интервью
   - AI агент формирует вопросы для валидации ценностного предложения
   - AI агент структурирует обратную связь после решенческих интервью
   - AI агент помогает скорректировать ценностное предложение на основе полученной обратной связи
</workflow_stages>

<general_process>
<process_title>Общий процесс работы с правилами для каждого этапа воркфлоу</process_title>

1. <process_step>Сбор входных данных от исследователя</process_step>
   - AI агент собирает информацию о целях, контексте и ограничениях исследования
   - Все данные тегируются в соответствии с правилом `0.3_ai_agent_prompt_tagging_rule.mdc`

2. <process_step>Утверждение дефолтных правил</process_step>
   - AI агент предлагает исследователю набор дефолтных правил для исполнения каждого этапа
   - Исследователь анализирует предложежения и предоставляет обратную связь
   - AI агент вносит корректировки в правила на основе обратной связи
   - Исследователь утверждает финально предложения агента и агент вносит замечания исследователя в правила

3. <process_step>Исполнение правил</process_step>
   - AI агент напрямую применяет утвержденные правила как промпты для обработки данных
   - AI агент сохраняет результаты в соответствующие файлы и папки согласно структуре (cм п.0)
   - Результаты представляются исследователю для анализа и обратной связи и только после этого утверждаются и обязательно записываются в соответствующие файлы в структуре. Каждое утверждение исследователем несет обязательную перезапись соответствующего результата
</general_process>

<workflow_milestones>

1. Постановка целей
   1.1 Определение исследовательских целей, стадии, бизнес-проблемы, аудитории, контекста исследований, гипотез и ограничений
   1.2 Определение исследовательских вопросов на основе целей исследования

2. Подготовка к интервью
   2.1 Определение фреймворка для определения потребностей пользователей
   2.2 Определение вопросов интервью на основе исследовательских вопросов и выбранного фреймворка
   2.3 Создание гайда интервью на основе вопросов интервью

3. Организация интервью
   3.1 Проведение тестового интервью с синтетическим респондентом
   3.2 Создание интро и фоллоу-ап сообщений для приглашения респондентов
   3.3 Персонализированная коммуникация с респондентами

4. Анализ интервью и формулирование потребностей
   4.1 Определение границ исследования
   4.2 Подготовка историй общения с клиентами
   4.3 Анализ историй общения с клиентами: извлечение вопросов и распределение цитат
   4.4 Идентификация и обогащение значимых цитат из интервью
   4.5 Анализ ответов на исследовательские вопросы
   4.6 Верификация точности формулировок потребностей клиентов
   4.7 Финальная верификация корректности формулировок
   4.8 Структурирование итоговых знаний о потребностях клиентов
   4.9 Проверка готовности к синтезу и подготовка к синтезу потребностей

5. Синтез общих знаний о сегменте
   5.1 Синтез знаний об общих для сегмента клиентов элементах потребностей
   5.2 Проверка результатов синтеза на отсутствие упущенных уникальных элементов
   5.3 Подбор подтверждающих цитат для синтезированных потребностей
   5.4 Верификация подтверждающих цитат

6. Сенсмейкинг
   6.1 Определение продуктовых гипотез на основе синтезированных знаний

7. Релиз
   7.1 Подготовка к решенческим интервью
</workflow_milestones>
   6.1 Определение продуктовых гипотез на основе синтезированных знаний

7. Релиз
   7.1 Подготовка к решенческим интервью

</workflow_milestones>