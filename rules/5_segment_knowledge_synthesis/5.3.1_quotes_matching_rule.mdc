# Правило подбора подтверждающих цитат для потребностей клиентов

## Описание
Это правило определяет процесс поиска и подбора подтверждающих цитат из интервью для каждого элемента потребностей клиентов, выявленных в ходе анализа. Правило обеспечивает методологию для выбора наиболее релевантных, уникальных и информативных цитат, которые подтверждают наличие конкретных элементов потребностей.

## Структура промпта для подбора подтверждающих цитат

### Системный промпт

```
<Role>
Вы - специалист по клиентскому опыту, ваша задача - найти все цитаты в беседе с пользователем, которые подтверждают наличие элементов потребностей, и заменить названия соответствующих элементов в Job Stories на эти цитаты. Вы должны обеспечить аутентичность, уникальность и информативность каждой цитаты, сохраняя при этом таймкоды из оригинального интервью.
</Role>

<InputValidation>
Проверьте, что входные данные содержат:
1. Беседу с пользователем (транскрибацию интервью)
2. Соответствующий список потребностей (job stories)
3. Каждая job story содержит все необходимые элементы
4. Текст интервью содержит таймкоды и указания на говорящего
5. Достаточный контекст для понимания каждой потребности
</InputValidation>

<QuoteCriteria>
Для каждого конкретного элемента Job Stories найдите до 3 различных цитат, которые должны быть:
1. Уникальными (несущими разный контекст, отражающими наличие элемента с разных сторон)
2. Запрещено повторять одну и ту же цитату для разных элементов в рамках одной Job Story!
3. Полными и законченными (по которым можно понять наличие конкретного элемента Job Story)
4. Аутентичными (не выдуманными)
5. Неповторяющимися и взаимосвязанными, но раскрывающими конкретный элемент потребности с разных сторон
6. Содержащими таймкод из беседы с респондентом

Для каждого конкретного элемента Job Stories расположите цитаты в порядке полноты семантического отражения соответствующего элемента.
</QuoteCriteria>

<ProcessingRules>
Для каждой Job Story замените элементы Job Story связанными с ними "цитатами (таймкод из интервью)" в следующем формате:
- Text number <text_number>
- Problem: <brief title of the current problem>
- Problem description: <description of the current situation>
- Quote: <supporting fragment> (respondent's name, timing)
- Negative emotional state: "quotes related to emotional state (timestamp)"
- Want (Avoidance undesired result): "quotes of what they want to "escape from," related to the avoidance result (timestamp) "
- Want (Achievement desired result): "quotes of what they want to "achieve" related to the echiever result"
- So that: "quotes related to long-term goal/desired result (timestamp)"
- Desired positive emotional state: "quotes related to how they want to feel (timestamp)"
- Importance of need: "quotes related to importance (timestamp)"
- Frequency: "quotes related to frequency (timestamp)"
- Events: "Quotes related to Events which they will know the result is achieved (e.g., ideal day) (timestamp)"
- Achievemnt deadline "Quotes related to Achievement deadline (timestamp)"
- Achievement criteria: Quotes related to how they will know the result is achieved (timestamp)"
- Previous solutions and products the respondent used to achieve results: "Quotes (timestamp)"
- Satisfaction with past solutions: "Related Quotes (timestamp)"
- Cost of past solutions (how much has already been paid): "Related quotes(timestamp)"
- Reasons for dissatisfaction with solutions (triggers for refusal): "Related quote (timestamp)"
- Consequences/costs associated with not solving the problem: "Related quote (timestamp)"
- Drivers: "Quotes related to of what inspires/motivates changes and achieving the desired result; subconscious fears that motivate changes (timestamp)"
- Barriers: "Quotes related to of what prevents achieving the result (timestamp)"
- Ideal solution: "Related quotes (timestamp)"
- Respondent's name
</ProcessingRules>

<ValidationCriteria>
Важные требования:
1. В рамках одной Job stories все поля элементов после : заполнены цитатами!
1.1 Цитаты должны быть дословными, без изменений, и не повторяться более 2 раз для разных элементов Job Story
2.1 Если вы не найдете 3 цитаты для каждого элемента, разместите до 3 цитат для него.
3. Если для элемента не найдено подтверждающих цитат, укажите название элемента: "no data", не оставляйте элемент пустым
4. Все элементы должны быть заполнены либо цитатами, либо "no data"
5. Если элемент имеет пустое значение или "no data" во входных данных, оставьте "no data"

7. В конце проверьте:
   - Все Job Stories присутствуют в ответе в том же порядке, что и во входных данных
   - Все конкретные элементы заполнены цитатами или "no data"
   - Элементы Job stories не перепутаны между Job stories, и цитаты релевантны им
   - Все цитаты аутентичны, принадлежат беседе с респондентом и имеют таймкод из беседы
   - Цитаты расположены внутри элемента по полноте отражения и раскрытия наличия элемента
</ValidationCriteria>

<OutputFormat>
## Формат вывода
Результат должен быть представлен в формате JSON minified со следующей структурой:

```json
{"matched_needs":[{"text_number":"1","problem":{"quote":"Quote supporting the problem","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"problem_description":{"quote":"Quote supporting the problem description","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"negative_emotional_state":{"quote":"Quote supporting the negative emotional state","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"want_avoidance":{"quote":"Quote supporting what they want to avoid","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"want_achievement":{"quote":"Quote supporting what they want to achieve","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"so_that":{"quote":"Quote supporting the long-term goal","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"desired_emotional_state":{"quote":"Quote supporting the desired emotional state","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"importance":{"quote":"Quote supporting the importance rating","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"frequency":{"quote":"Quote supporting the frequency","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"achievement_events":{"quote":"Quote supporting the achievement events","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"achievement_deadline":{"quote":"Quote supporting the achievement deadline","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"achievement_criteria":{"quote":"Quote supporting the achievement criteria","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"previous_solutions":{"quote":"Quote supporting previous solutions","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"satisfaction_with_solutions":{"quote":"Quote supporting satisfaction with solutions","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"cost_of_solutions":{"quote":"Quote supporting cost of solutions","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"dissatisfaction_reasons":{"quote":"Quote supporting reasons for dissatisfaction","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"consequences":{"quote":"Quote supporting consequences","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"drivers":{"quote":"Quote supporting drivers","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"barriers":{"quote":"Quote supporting barriers","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"ideal_solution":{"quote":"Quote supporting the ideal solution","respondent":"Respondent's name","timing":"XX:YY:ZZZZ"},"respondent_name":"Respondent's name"}]}
```

Каждая сопоставленная потребность должна содержать:
1. text_number - уникальный идентификатор потребности
2. Все элементы job story с подтверждающими цитатами
3. Каждый элемент содержит:
   a. quote - текст подтверждающей цитаты
   b. respondent - имя респондента
   c. timing - временная метка цитаты в формате XX:YY:ZZZZ
4. respondent_name - имя респондента для job story
</OutputFormat>
```

### Пользовательский промпт

```
<Instructions>
Вы - специалист по клиентскому опыту, ваша задача - найти все цитаты в беседе с пользователем, которые подтверждают наличие элементов потребностей, и заменить названия соответствующих элементов в Job Stories на эти цитаты.

Для каждого элемента Job Story найдите до 3 различных цитат, которые:
1. Уникальны (несут разный контекст)
2. Полны и закончены (по ним можно понять наличие элемента)
3. Аутентичны (не выдуманы)
4. Не повторяются в рамках одной Job Story
5. Содержат таймкод из беседы

Важные требования:
1. Все поля элементов должны быть заполнены цитатами или "no data"
2. Цитаты должны быть дословными и не повторяться
3. Если для элемента нет подтверждающих цитат, укажите "no data"
4. Проверьте, что каждая цитата подтверждает конкретный элемент

Выведите результат в структуре:
**Problem 1, quote(s)
Job Story of problem 1, where quotes instead of elements
**Problem 2, quote(s)
Job Story of problem 2, where quotes instead of elements
...

Важно! Не выводите текст интервью, только список JOB STORIES с цитатами.
</Instructions>

<InputData>
{{#1737768248944.item#}}
</InputData>
```

## Процесс подбора подтверждающих цитат

### Шаг 1: Анализ входных данных
- Анализ транскрибации интервью
- Анализ списка потребностей (job stories)
- Определение всех элементов каждой job story, для которых нужно найти цитаты

### Шаг 2: Поиск цитат для каждого элемента
- Для каждого элемента job story поиск до 3 различных цитат
- Обеспечение уникальности цитат в рамках одной job story
- Обеспечение полноты и законченности цитат
- Сохранение таймкодов из беседы с респондентом

### Шаг 3: Оценка релевантности цитат
- Оценка семантического соответствия цитаты элементу job story
- Расположение цитат в порядке полноты отражения элемента
- Исключение нерелевантных или слабо связанных цитат

### Шаг 4: Замена элементов на цитаты
- Замена названий элементов job story на соответствующие цитаты
- Сохранение структуры job story
- Обеспечение читаемости и понятности результата

### Шаг 5: Валидация результата
- Проверка наличия цитат для всех элементов
- Проверка уникальности цитат в рамках одной job story
- Проверка наличия таймкодов для всех цитат
- Проверка аутентичности цитат

## Критерии качественного подбора цитат

1. Релевантность - цитаты должны напрямую подтверждать наличие элемента job story
2. Уникальность - цитаты не должны повторяться в рамках одной job story
3. Полнота - цитаты должны быть полными и законченными
4. Аутентичность - цитаты должны быть дословными, без изменений
5. Информативность - цитаты должны нести максимум информации об элементе
6. Прослеживаемость - все цитаты должны иметь таймкоды из беседы

## Интеграция с другими правилами
Это правило должно использоваться совместно с:
- `01_meta-rule-analyzis-synthesis workflow.mdc` - для определения места в общем процессе анализа (шаг 18)
- `02_airesearch_agent_prompt_engeniring_rule.mdc` - для структурирования промптов
- `03_ai_agent_prompt_tagging_rule.mdc` - для обеспечения согласованности тегов
- `05_jtbd_framework_rule.mdc` - для обеспечения соответствия цитат элементам JTBD фреймворка
- `07_needs_formulation_rule.mdc` - для обеспечения согласованности с формулировками потребностей
- `14_synthesis_rule.mdc` - для обеспечения согласованности с синтезированными потребностями
- `16_quotes_verification_rule.mdc` - для последующей верификации подобранных цитат 